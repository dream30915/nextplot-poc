<!DOCTYPE html>
<html lang="th" data-theme="dark">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>NextPlot Portal ‚Äì Auth / Profile / Admin Request</title>
<meta name="description" content="Portal with Supabase Auth, profile, admin role request workflow" />
<style>
:root {
  --bg:#101317;--bg-alt:#181d23;--bg-alt2:#20262d;
  --border:#2b333c;--border-soft:#36404a;
  --text:#f1f5f9;--text-dim:#94a3b8;
  --accent:#3b82f6;--accent-hover:#2563eb;
  --danger:#dc2626;--warn:#f59e0b;--success:#10b981;
  --radius:14px;--radius-sm:6px;
  --focus-ring:0 0 0 3px rgba(59,130,246,.35);
  --grad:linear-gradient(135deg,#1e3a8a,#3b82f6,#06b6d4);
  --shadow:0 4px 14px -2px rgba(0,0,0,.5);
}
[data-theme="light"] {
  --bg:#f5f7fa;--bg-alt:#ffffff;--bg-alt2:#f0f4f8;
  --border:#d0d7e2;--border-soft:#e2e8f0;
  --text:#0f172a;--text-dim:#475569;
  --grad:linear-gradient(135deg,#2563eb,#06b6d4,#3b82f6);
  --shadow:0 4px 16px -2px rgba(0,0,0,.15);
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif;
     background:var(--bg);color:var(--text);line-height:1.5;min-height:100vh;
     display:flex;flex-direction:column;}
h3{margin:0 0 .7rem;font-weight:600;letter-spacing:.5px;}
header{display:flex;align-items:center;justify-content:space-between;
       padding:16px 26px;background:var(--bg-alt);border-bottom:1px solid var(--border);
       position:sticky;top:0;z-index:50;}
header .brand{font-size:1.05rem;font-weight:600;background:var(--grad);
              -webkit-background-clip:text;color:transparent;letter-spacing:.7px;}
.pill{display:inline-flex;align-items:center;gap:6px;font-size:.7rem;font-weight:600;
      padding:4px 10px;background:var(--bg-alt2);border:1px solid var(--border);
      border-radius:999px;color:var(--text-dim);}
.container{width:100%;max-width:1320px;margin:0 auto;
           padding:28px clamp(16px,2.2vw,40px) 80px;flex:1;display:grid;gap:28px;
           grid-template-columns:repeat(auto-fit,minmax(330px,1fr));}
.panel{background:var(--bg-alt);border:1px solid var(--border);
       border-radius:14px;padding:22px 24px 26px;box-shadow:var(--shadow);
       display:flex;flex-direction:column;gap:14px;}
.panel-header{display:flex;align-items:center;justify-content:space-between;gap:12px;}
.divider{height:1px;background:var(--border-soft);margin:4px 0 6px;}
label{display:flex;flex-direction:column;gap:6px;font-size:.65rem;font-weight:600;
      letter-spacing:.5px;color:var(--text-dim);text-transform:uppercase;}
input,textarea,select{background:var(--bg-alt2);border:1px solid var(--border);color:var(--text);
      padding:10px 14px;border-radius:8px;font-size:.8rem;transition:.25s;resize:vertical;}
input:focus,textarea:focus,select:focus{outline:none;border-color:var(--accent);box-shadow:var(--focus-ring);}
textarea{min-height:70px;max-height:200px;}
.actions-row{display:flex;flex-wrap:wrap;gap:10px;margin-top:4px;}
button{cursor:pointer;background:var(--accent);color:#fff;font-weight:600;font-size:.75rem;
       padding:11px 16px;border:none;border-radius:8px;letter-spacing:.4px;
       display:inline-flex;align-items:center;gap:8px;transition:.25s;}
button:hover{background:var(--accent-hover);}
button.outline{background:var(--bg-alt2);color:var(--text-dim);border:1px solid var(--border);}
button.outline:hover{color:var(--text);}
button.danger{background:var(--danger);}
button:disabled{opacity:.55;cursor:not-allowed;}
.role-badge{font-size:.55rem;padding:4px 8px;border-radius:999px;background:var(--bg-alt2);
            border:1px solid var(--border);font-weight:600;letter-spacing:.4px;}
.role-USER{color:var(--text-dim);}
.role-ADMIN{color:var(--warn);border-color:var(--warn);}
.role-SUPER_ADMIN{color:var(--success);border-color:var(--success);}
pre{background:var(--bg-alt2);border:1px solid var(--border);padding:14px 16px;
    border-radius:10px;font-size:.7rem;max-height:400px;overflow:auto;margin:0;}
.log-toggle{position:fixed;bottom:18px;right:18px;background:var(--bg-alt2);border:1px solid var(--border);
            width:54px;height:54px;display:flex;align-items:center;justify-content:center;
            font-size:1.1rem;border-radius:16px;cursor:pointer;box-shadow:var(--shadow);z-index:70;}
.logs-drawer{position:fixed;bottom:90px;right:18px;width:min(560px,92vw);height:420px;
             background:var(--bg-alt);border:1px solid var(--border);border-radius:22px;
             display:flex;flex-direction:column;box-shadow:0 10px 40px -6px rgba(0,0,0,.55);
             overflow:hidden;transform:translateY(12px);opacity:0;pointer-events:none;
             transition:.35s;backdrop-filter:blur(6px);z-index:65;}
.logs-drawer.active{transform:translateY(0);opacity:1;pointer-events:auto;}
.drawer-header{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;
               border-bottom:1px solid var(--border);}
.drawer-body{flex:1;overflow:auto;padding:12px 16px 20px;}
.log-line{font-size:.65rem;font-family:ui-monospace,monospace;border-left:3px solid var(--border);
          padding:4px 8px 4px 10px;margin:0 0 6px;background:var(--bg-alt2);border-radius:6px;white-space:pre-wrap;word-break:break-word;}
.log-line.STATUS{border-color:var(--accent);}
.log-line.ERROR{border-color:var(--danger);color:#fca5a5;}
.log-line.INFO{border-color:var(--accent);}
.avatar{width:58px;height:58px;background:var(--bg-alt2);border:1px solid var(--border);
        border-radius:16px;display:flex;align-items:center;justify-content:center;
        font-weight:600;color:var(--accent);font-size:1rem;}
.profile-grid{display:grid;gap:18px;grid-template-columns:68px 1fr;}
.toast{position:fixed;top:18px;right:18px;background:var(--bg-alt2);border:1px solid var(--border);
       padding:12px 16px;border-radius:10px;font-size:.75rem;box-shadow:var(--shadow);
       opacity:0;transform:translateY(-10px);pointer-events:none;transition:.35s;z-index:120;}
.toast.show{opacity:1;transform:translateY(0);}
.tag{font-size:.55rem;text-transform:uppercase;padding:4px 8px;background:var(--bg-alt2);
     border:1px solid var(--border);border-radius:6px;letter-spacing:.6px;color:var(--text-dim);}
.theme-btn{width:42px;height:42px;border-radius:12px;border:1px solid var(--border);
           background:var(--bg-alt2);display:flex;align-items:center;justify-content:center;
           cursor:pointer;font-size:1.05rem;color:var(--text-dim);}
.theme-btn:hover{color:var(--text);background:var(--bg-alt);}
textarea::-webkit-scrollbar,pre::-webkit-scrollbar{width:8px;}
textarea::-webkit-scrollbar-thumb,pre::-webkit-scrollbar-thumb{background:var(--border-soft);border-radius:4px;}
@media (max-width:900px){.container{padding-top:18px;}header{flex-wrap:wrap;gap:12px;}}
</style>
</head>
<body>
<header>
  <div class="brand">NextPlot Portal</div>
  <div style="display:flex;align-items:center;gap:10px;">
    <div id="sessionBadge" class="pill">No Session</div>
    <button id="themeToggle" class="theme-btn" title="Toggle Theme">üåô</button>
    <button id="logoutBtn" class="outline" disabled>Logout</button>
  </div>
</header>

<main class="container">
  <!-- AUTH -->
  <section class="panel">
    <div class="panel-header"><h3>Authentication</h3><span class="tag">SECURE</span></div>
    <div class="divider"></div>
    <div style="display:flex;gap:14px;flex-wrap:wrap;">
      <label style="flex:1">Email
        <input id="email" type="email" placeholder="you@example.com" autocomplete="off">
      </label>
      <label style="flex:1">Password
        <input id="password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
      </label>
    </div>
    <div class="actions-row">
      <button id="signupBtn">Sign Up</button>
      <button id="signinBtn" class="outline">Sign In</button>
      <button id="ensureBtn" class="outline" disabled>Ensure Profile</button>
      <button id="refreshProfileBtn" class="outline" disabled>Refresh Profile</button>
    </div>
    <small class="muted">‡∏™‡∏°‡∏±‡∏Ñ‡∏£ / ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á profile ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</small>
  </section>

  <!-- PROFILE -->
  <section class="panel">
    <div class="panel-header"><h3>Profile</h3><span class="tag">RLS</span></div>
    <div class="divider"></div>
    <div id="profileContent"><div class="muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</div></div>
    <div class="actions-row" style="margin-top:6px;">
      <input id="displayNameInput" placeholder="Display Name" style="flex:1;padding:10px;" disabled>
      <button id="updateNameBtn" class="outline" disabled>Update Name</button>
    </div>
  </section>

  <!-- REQUEST ADMIN -->
  <section class="panel">
    <div class="panel-header"><h3>‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Admin</h3><span class="tag">ROLE REQUEST</span></div>
    <div class="divider"></div>
    <div id="requestStatus"
